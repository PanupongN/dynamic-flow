# Draft Status & Diff System Guide

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏£‡∏∞‡∏ö‡∏ö Draft Status ‡πÅ‡∏•‡∏∞ Diff ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á draft version ‡πÅ‡∏•‡∏∞ published version ‡∏Ç‡∏≠‡∏á flow ‡πÅ‡∏ö‡∏ö real-time

## ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å

### 1. Draft Status Indicator
‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ FlowBuilder:

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Flow ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà publish:**
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Flow ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Publish"
- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô AlertCircle ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Flow ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Publish"
- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô GitBranch ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
- ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á ‡πÄ‡∏ä‡πà‡∏ô "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç 2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡πÄ‡∏û‡∏¥‡πà‡∏° 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
- ‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π diff ‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### 2. Detailed Diff View
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á:

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á:**
- üü¢ **‡πÄ‡∏û‡∏¥‡πà‡∏°** - ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô published version
- üîµ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç** - ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å published version  
- üî¥ **‡∏•‡∏ö** - ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å published version

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- ‡∏ä‡∏∑‡πà‡∏≠ Flow (title)
- ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (description)
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô steps ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ step
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ step
- ‡∏ò‡∏µ‡∏° (theme)
- ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ (settings)

### 3. Draft Status Badge
‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Dashboard ‡∏ö‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ flows:

- Badge ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà publish" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö flow ‡πÉ‡∏´‡∏°‡πà
- Badge ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö flow ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
- ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô

### Data Structure
‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:

```typescript
{
  id: "flow-id",
  title: "‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô",
  // ... ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• draft ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  versions: {
    draft: { /* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• draft */ },
    published: { /* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• published ‡∏´‡∏£‡∏∑‡∏≠ null */ }
  }
}
```

### Components

**1. `DraftStatusIndicator`**
- ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ FlowBuilder
- ‡∏£‡∏±‡∏ö `currentFlow` ‡πÄ‡∏õ‡πá‡∏ô props
- ‡πÅ‡∏™‡∏î‡∏á warning banner ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

**2. `DraftStatusBadge`**  
- ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Dashboard
- ‡πÅ‡∏™‡∏î‡∏á badge ‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ö‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö size `small` ‡πÅ‡∏•‡∏∞ `medium`

**3. `diffUtils.ts`**
- `compareFlowVersions()` - ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2 versions
- `getDiffSummary()` - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ
- ‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô `DiffResult` ‡∏û‡∏£‡πâ‡∏≠‡∏° array ‡∏Ç‡∏≠‡∏á `Difference`

### Difference Types

```typescript
interface Difference {
  type: 'added' | 'modified' | 'removed';
  section: 'title' | 'description' | 'steps' | 'settings' | 'theme';
  path: string;
  oldValue?: any;
  newValue?: any;
  description: string; // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
}
```

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:

1. **‡∏™‡∏£‡πâ‡∏≤‡∏á Flow ‡πÉ‡∏´‡∏°‡πà:**
   - ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô warning "Flow ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Publish"
   - ‡∏Å‡∏î "Publish" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà

2. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Flow ‡∏ó‡∏µ‡πà publish ‡πÅ‡∏•‡πâ‡∏ß:**
   - ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏û‡∏¥‡πà‡∏° step)
   - ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô warning "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Publish"
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π diff
   - ‡∏Å‡∏î "Update Published" ‡πÄ‡∏û‡∏∑‡πà‡∏≠ update

3. **‡πÉ‡∏ô Dashboard:**
   - ‡∏î‡∏π badge ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ flow
   - ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

### ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Developer:

**‡πÄ‡∏û‡∏¥‡πà‡∏° DraftStatusIndicator:**
```tsx
import { DraftStatusIndicator } from '../components/DraftStatusIndicator';

<DraftStatusIndicator currentFlow={currentFlow} />
```

**‡πÄ‡∏û‡∏¥‡πà‡∏° DraftStatusBadge:**
```tsx
import { DraftStatusBadge } from '../components/DraftStatusIndicator';

<DraftStatusBadge currentFlow={flow} size="small" />
```

**‡πÉ‡∏ä‡πâ diff utilities:**
```tsx
import { compareFlowVersions, getDiffSummary } from '../utils/diffUtils';

const diffResult = compareFlowVersions(draftData, publishedData);
const summary = getDiffSummary(diffResult);
```

## Styling

‡πÉ‡∏ä‡πâ Tailwind CSS classes:
- ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (`amber-*`) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö warning/draft status
- ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (`green-*`) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö added items
- ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (`blue-*`) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö modified items  
- ‡∏™‡∏µ‡πÅ‡∏î‡∏á (`red-*`) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö removed items

## ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î

1. **‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ö‡∏ö Shallow:** ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏Ñ‡πà level ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á objects
2. **‡πÑ‡∏°‡πà‡∏°‡∏µ Visual Diff:** ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ side-by-side comparison
3. **‡πÑ‡∏°‡πà Persist Expand State:** ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ expand/collapse ‡∏à‡∏∞ reset ‡πÄ‡∏°‡∏∑‡πà‡∏≠ re-render

## ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠

1. **Deep Object Comparison:** ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö field validation, logic conditions
2. **Visual Diff Component:** ‡πÅ‡∏™‡∏î‡∏á before/after ‡πÅ‡∏ö‡∏ö side-by-side
3. **Diff History:** ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
4. **Collaborative Editing:** ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô
